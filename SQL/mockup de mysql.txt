
CREATE DATABASE kali_racers;
USE kali_racers;

CREATE TABLE usuarios (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(150) NOT NULL,
    cpf CHAR(11) NOT NULL UNIQUE,
    nascimento DATE NOT NULL,
    sexo ENUM('masculino', 'feminino', 'outro') NOT NULL,
    mae VARCHAR(150) NOT NULL,
    telefone VARCHAR(15),
    celular VARCHAR(15) NOT NULL,
    endereco VARCHAR(255) NOT NULL,
    email VARCHAR(150) NOT NULL UNIQUE,
    ulogin VARCHAR(50) NOT NULL UNIQUE,
    senha VARCHAR(255) NOT NULL,  -- vai armazenar o hash (password_hash gera até 255 caracteres)
    pergunta ENUM('cachorro', 'cor', 'musica') NOT NULL,
    resposta VARCHAR(255) NOT NULL,
    criado_em TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE tipo(
    id_tipo INT PRIMARY KEY AUTO_INCREMENT,
    tipo_prod ENUM('turbinas', 'perifericos', 'alimentacao', 'power train') NOT NULL
);


CREATE TABLE produtos (
    id_prod INT AUTO_INCREMENT PRIMARY KEY,
    nome_prod VARCHAR(255) NOT NULL,
    id_tipo INT,
    marca_prod VARCHAR(255) NOT NULL,
    preco DECIMAL(10,2) NOT NULL,
    quant INT NOT NULL,
    FOREIGN KEY (id_tipo) REFERENCES tipo(id_tipo)
);

INSERT INTO tipo (tipo_prod)
VALUES ('power train'),
('turbinas'),
('periféricos'),
('alimentacao');


CREATE TABLE log_usuarios (
    logid INT AUTO_INCREMENT PRIMARY KEY,
    id INT NOT NULL,
    action VARCHAR(50) NOT NULL,
    details TEXT NULL,
    ip_address VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (id) REFERENCES usuarios(id)
);
